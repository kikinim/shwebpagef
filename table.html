<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì„¤í™”ìŠ¤í„°ë”” ğŸ“Š í†µí•© ê³µë¶€ ê·¸ë˜í”„</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Pretendard', sans-serif;
      padding: 20px;
      background: #fdfdfd;
    }
    h1, h2 {
      color: #333;
    }
    canvas {
  display: block;
  width: 100%;         /* ğŸ’¡ ì „ì²´ ë„ˆë¹„ ì±„ìš°ê¸° */
  height: 300px;       /* ë†’ì´ëŠ” ê³ ì • */
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 0 10px rgba(0,0,0,0.05);
  margin-bottom: 40px;
}
  </style>
</head>
<body>
  <h1>ì„¤í™”ìŠ¤í„°ë”” ê³µë¶€ í†µê³„</h1>

  <h2>1. ë‚ ì§œë³„ ìˆœê³µì‹œê°„</h2>
  <canvas id="studyChart"  height="300"></canvas>

  <h2>2. ë‚ ì§œë³„ ìˆ˜í–‰í‰ê°€ ì‹œê°„</h2>
  <canvas id="evalChart"  height="300"></canvas>

  <h2>3. ë‚ ì§œë³„ ê³¼ëª©ë³„ í”Œëœ ìˆ˜</h2>
  <canvas id="planChart"  height="300"></canvas>

  <h2>4. ê³¼ëª©ë³„ ì „ì²´ í”Œëœ ìˆ˜</h2>
  <canvas id="subjectChart"  height="300"></canvas>

  <!-- 5. ê³¼ëª©ë³„ ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ ë³€í™” -->
  <h2>5. ê³¼ëª©ë³„ ëª¨ì˜ê³ ì‚¬ ì ìˆ˜ ë³€í™”</h2>
   <h2>êµ­ì–´</h2>
  <canvas id="score_korean"></canvas>
   <h2>ì˜ì–´</h2>
  <canvas id="score_english"></canvas>
   <h2>ìˆ˜í•™</h2>
  <canvas id="score_math"></canvas>
   <h2>ì‚¬íšŒ</h2>
  <canvas id="score_social"></canvas>
   <h2>ê³¼í•™</h2>
  <canvas id="score_science"></canvas>

  <script>
    async function fetchAndDraw() {
      const studyData = await (await fetch('public/study_time.json')).json();
      const evalData = await (await fetch('public/eval_time.json')).json();
      const planData = await (await fetch('public/plan_count.json')).json();
      const subjectData = await (await fetch('public/subject_plan_count.json')).json();

      const pastelColors = [
        '#f7b5c7', '#f7d794', '#c8d6e5', '#d1ccc0', '#f3a683', '#778beb'
      ];

      // 1. ë‚ ì§œë³„ ìˆœê³µì‹œê°„
      new Chart(document.getElementById("studyChart"), {
        type: 'bar',
        data: {
          labels: studyData.map(d => d["ë‚ ì§œ"]),
          datasets: [{
            label: "ìˆœê³µì‹œê°„",
            data: studyData.map(d => d["ìˆœê³µì‹œê°„"]),
            backgroundColor: pastelColors[0]
          }]
        },
        options: { responsive: true, scales: { y: { beginAtZero: true } } }
      });

      // 2. ìˆ˜í–‰í‰ê°€ ì‹œê°„
      new Chart(document.getElementById("evalChart"), {
        type: 'bar',
        data: {
          labels: evalData.map(d => d["ë‚ ì§œ"]),
          datasets: [{
            label: "ìˆ˜í–‰í‰ê°€ ì‹œê°„",
            data: evalData.map(d => d["ìˆœê³µì‹œê°„_ìˆ˜í–‰í‰ê°€"]),
            backgroundColor: pastelColors[1]
          }]
        },
        options: { responsive: true, scales: { y: { beginAtZero: true } } }
      });

      // 3. ë‚ ì§œë³„ ê³¼ëª©ë³„ í”Œëœ ìˆ˜
      const dates = [...new Set(planData.map(d => d["ë‚ ì§œ"]))];
      const subjects = [...new Set(planData.map(d => d["ê³¼ëª©"]))];
      const datasets = subjects.map((subj, i) => ({
        label: subj,
        data: dates.map(date =>
          planData.find(d => d["ë‚ ì§œ"] === date && d["ê³¼ëª©"] === subj)?.["í”Œëœìˆ˜"] || 0),
        backgroundColor: pastelColors[i % pastelColors.length],
        stack: "stack1"
      }));

      new Chart(document.getElementById("planChart"), {
        type: 'bar',
        data: { labels: dates, datasets },
        options: {
          responsive: true,
          plugins: { title: { display: false } },
          scales: {
            x: { stacked: true },
            y: { stacked: true, beginAtZero: true }
          }
        }
      });

      // 4. ê³¼ëª©ë³„ ì „ì²´ í”Œëœ ìˆ˜
      new Chart(document.getElementById("subjectChart"), {
        type: 'bar',
        data: {
          labels: subjectData.map(d => d["ê³¼ëª©"]),
          datasets: [{
            label: 'í”Œëœ ìˆ˜',
            data: subjectData.map(d => d["í”Œëœìˆ˜"]),
            backgroundColor: pastelColors.slice(0, subjectData.length)
          }]
        },
        options: {
          responsive: true,
          scales: { y: { beginAtZero: true, ticks: { precision: 0 } } }
        }
      });

      // 5. ê³¼ëª©ë³„ ì ìˆ˜ ë³€í™” ê·¸ë˜í”„
      const mockExamData = [
        { ê³¼ëª©: "êµ­ì–´", ì›ì ìˆ˜: 87, í‘œì¤€ì ìˆ˜: 105, ë°±ë¶„ìœ„: 90, ë“±ê¸‰: 1, ë‚ ì§œ: "2025-03-01" },
        { ê³¼ëª©: "êµ­ì–´", ì›ì ìˆ˜: 91, í‘œì¤€ì ìˆ˜: 109, ë°±ë¶„ìœ„: 93, ë“±ê¸‰: 1, ë‚ ì§œ: "2025-06-01" },
        { ê³¼ëª©: "êµ­ì–´", ì›ì ìˆ˜: 63, í‘œì¤€ì ìˆ˜: 97,  ë°±ë¶„ìœ„: 72, ë“±ê¸‰: 2, ë‚ ì§œ: "2025-09-01" },
        { ê³¼ëª©: "êµ­ì–´", ì›ì ìˆ˜: 74, í‘œì¤€ì ìˆ˜: 100, ë°±ë¶„ìœ„: 83, ë“±ê¸‰: 2, ë‚ ì§œ: "2025-11-01" },
        { ê³¼ëª©: "ì˜ì–´", ì›ì ìˆ˜: 66, í‘œì¤€ì ìˆ˜: 98,  ë°±ë¶„ìœ„: 78, ë“±ê¸‰: 2, ë‚ ì§œ: "2025-03-01" },
        { ê³¼ëª©: "ì˜ì–´", ì›ì ìˆ˜: 53, í‘œì¤€ì ìˆ˜: 89,  ë°±ë¶„ìœ„: 61, ë“±ê¸‰: 3, ë‚ ì§œ: "2025-06-01" },
        { ê³¼ëª©: "ì˜ì–´", ì›ì ìˆ˜: 48, í‘œì¤€ì ìˆ˜: 85,  ë°±ë¶„ìœ„: 57, ë“±ê¸‰: 3, ë‚ ì§œ: "2025-09-01" },
        { ê³¼ëª©: "ì˜ì–´", ì›ì ìˆ˜: 92, í‘œì¤€ì ìˆ˜: 112, ë°±ë¶„ìœ„: 96, ë“±ê¸‰: 1, ë‚ ì§œ: "2025-11-01" },
        { ê³¼ëª©: "ìˆ˜í•™", ì›ì ìˆ˜: 45, í‘œì¤€ì ìˆ˜: 87,  ë°±ë¶„ìœ„: 55, ë“±ê¸‰: 4, ë‚ ì§œ: "2025-03-01" },
        { ê³¼ëª©: "ìˆ˜í•™", ì›ì ìˆ˜: 78, í‘œì¤€ì ìˆ˜: 104, ë°±ë¶„ìœ„: 88, ë“±ê¸‰: 2, ë‚ ì§œ: "2025-06-01" },
        { ê³¼ëª©: "ìˆ˜í•™", ì›ì ìˆ˜: 88, í‘œì¤€ì ìˆ˜: 110, ë°±ë¶„ìœ„: 95, ë“±ê¸‰: 1, ë‚ ì§œ: "2025-09-01" },
        { ê³¼ëª©: "ìˆ˜í•™", ì›ì ìˆ˜: 51, í‘œì¤€ì ìˆ˜: 90,  ë°±ë¶„ìœ„: 66, ë“±ê¸‰: 3, ë‚ ì§œ: "2025-11-01" },
        { ê³¼ëª©: "ì‚¬íšŒ", ì›ì ìˆ˜: 72, í‘œì¤€ì ìˆ˜: 102, ë°±ë¶„ìœ„: 85, ë“±ê¸‰: 2, ë‚ ì§œ: "2025-03-01" },
        { ê³¼ëª©: "ì‚¬íšŒ", ì›ì ìˆ˜: 41, í‘œì¤€ì ìˆ˜: 80,  ë°±ë¶„ìœ„: 43, ë“±ê¸‰: 4, ë‚ ì§œ: "2025-06-01" },
        { ê³¼ëª©: "ì‚¬íšŒ", ì›ì ìˆ˜: 62, í‘œì¤€ì ìˆ˜: 96,  ë°±ë¶„ìœ„: 76, ë“±ê¸‰: 3, ë‚ ì§œ: "2025-09-01" },
        { ê³¼ëª©: "ì‚¬íšŒ", ì›ì ìˆ˜: 36, í‘œì¤€ì ìˆ˜: 76,  ë°±ë¶„ìœ„: 39, ë“±ê¸‰: 5, ë‚ ì§œ: "2025-11-01" },
        { ê³¼ëª©: "ê³¼í•™", ì›ì ìˆ˜: 59, í‘œì¤€ì ìˆ˜: 95,  ë°±ë¶„ìœ„: 70, ë“±ê¸‰: 3, ë‚ ì§œ: "2025-03-01" },
        { ê³¼ëª©: "ê³¼í•™", ì›ì ìˆ˜: 68, í‘œì¤€ì ìˆ˜: 98,  ë°±ë¶„ìœ„: 78, ë“±ê¸‰: 2, ë‚ ì§œ: "2025-06-01" },
        { ê³¼ëª©: "ê³¼í•™", ì›ì ìˆ˜: 55, í‘œì¤€ì ìˆ˜: 92,  ë°±ë¶„ìœ„: 65, ë“±ê¸‰: 3, ë‚ ì§œ: "2025-09-01" },
        { ê³¼ëª©: "ê³¼í•™", ì›ì ìˆ˜: 69, í‘œì¤€ì ìˆ˜: 99,  ë°±ë¶„ìœ„: 79, ë“±ê¸‰: 2, ë‚ ì§œ: "2025-11-01" }
      ];

      const drawScoreChart = (subject, canvasId) => {
        const filtered = mockExamData.filter(d => d.ê³¼ëª© === subject);
        const labels = filtered.map(d => d.ë‚ ì§œ);
        const metrics = ["ì›ì ìˆ˜", "í‘œì¤€ì ìˆ˜", "ë°±ë¶„ìœ„", "ë“±ê¸‰"];
        const dataset = metrics.map((m, i) => ({
          label: m,
          data: filtered.map(d => d[m]),
          backgroundColor: pastelColors[i % pastelColors.length]
        }));

        new Chart(document.getElementById(canvasId), {
          type: 'bar',
          data: { labels, datasets: dataset },
          options: {
            responsive: true,
            plugins: { legend: { position: "top" } },
            scales: { y: { beginAtZero: true, max: 120 } }
          }
        });
      };

      drawScoreChart("êµ­ì–´", "score_korean");
      drawScoreChart("ì˜ì–´", "score_english");
      drawScoreChart("ìˆ˜í•™", "score_math");
      drawScoreChart("ì‚¬íšŒ", "score_social");
      drawScoreChart("ê³¼í•™", "score_science");
    }

    fetchAndDraw();
  </script>
</body>
</html>
